server {
    listen 80;
    server_name localhost;

    # =========================================================
    # 1. ARCHIVOS QUE DEBE SERVIR LARAVEL (BACKEND)
    # =========================================================
    
    # CSS del Login y Registro
    location = /css/style.css {
        proxy_pass http://backend:80;
        proxy_set_header Host $host;
    }

    # ---> NUEVO: CSS del Dashboard (La corrección que hicimos hoy) <---
    location = /css/dashboard.css {
        proxy_pass http://backend:80;
        proxy_set_header Host $host;
    }

    # JS del Login y Registro
    location = /js/script.js {
        proxy_pass http://backend:80;
        proxy_set_header Host $host;
    }

    # ---> NUEVO: JS del Dashboard (La corrección que hicimos hoy) <---
    location = /js/dashboard.js {
        proxy_pass http://backend:80;
        proxy_set_header Host $host;
    }

    # Rutas de autenticación y lógica de Laravel
    # (Si la URL empieza por /login, /register, /dashboard, etc...)
    location ~ ^/(login|register|dashboard|logout|password|email|sanctum|api) {
        proxy_pass http://backend:80;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    # =========================================================
    # 2. ARCHIVOS QUE DEBE SERVIR EL FRONTEND (LANDING PAGE)
    # =========================================================

    # Cualquier cosa en /css/, /js/ o /img/ que NO sea lo de arriba
    location /css/ {
        proxy_pass http://frontend:80;
    }
    location /js/ {
        proxy_pass http://frontend:80;
    }
    location /img/ {
        proxy_pass http://frontend:80;
    }

    # =========================================================
    # 3. ROOT (PÁGINA DE INICIO)
    # =========================================================
    
    # La raíz carga la Landing Page (Frontend)
    location = / {
        proxy_pass http://frontend:80;
    }

    # =========================================================
    # 4. TODO LO DEMÁS (CATCH-ALL) -> LARAVEL
    # =========================================================
    
    # Si no coincide con nada de lo anterior, se lo enviamos a Laravel
    # por si es una ruta interna o un error 404 que maneja el framework.
    location / {
        proxy_pass http://backend:80;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}